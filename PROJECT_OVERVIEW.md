# Project Overview: Content Hub Template

## 1. Introduction
    - **Purpose**: This repository serves as a template for creating modular content hubs, allowing for the organized presentation of diverse web content.
    - **Core Idea**: To display various types of content (static HTML pages, interactive JavaScript components, etc.) within a consistent application shell. This shell features a collapsible sidebar for navigation, dynamic Table of Contents generation, and user-selectable theming.
    - **Intended Use**: Designed as a starting point for projects that require a simple yet flexible way to organize and present a collection of web-based materials or small applications.

## 2. Core Features
    - **Collapsible Sidebar Navigation**: Provides a clean and accessible way to navigate content, housing the Table of Contents. The sidebar's state (collapsed/expanded) is persisted using `localStorage`.
    - **Dynamic Table of Contents (TOC)**: `toc.html` is automatically generated by scanning the content in the `EXPRESS/` directory. It supports nested structures for primary and secondary pages within sections.
    - **Iframe Content Display**: Main content is loaded into an iframe. This encapsulates content styling and scripting, preventing conflicts with the main application shell.
    - **Light/Dark Themes**: User-selectable light and dark themes are available. The choice persists across sessions via `localStorage` and is propagated to iframe content using `postMessage`.
    - **Password Protection**: A client-side login page (`login.html`) protects access to the content. Authentication is based on SHA256 hash comparison, and the session status (`isAuthenticated`) is stored in `sessionStorage`.

## 3. Project Structure
    - `index.html`: The main application shell that hosts the sidebar, content iframe, and theme toggle. It handles redirection to `login.html` if the user is not authenticated.
    - `login.html`: The dedicated login page. It handles password input, hashing, and authentication logic.
    - `toc.html`: The Table of Contents, dynamically generated by `generate-toc.js`. This file is loaded into the sidebar of `index.html`.
    - `assets/`: Contains static assets like stylesheets and images (if any).
        - `assets/styles/main.css`: The main stylesheet for the application shell and content pages. It includes CSS variable definitions for theming and styles for the login page and Table of Contents.
    - `EXPRESS/`: The root directory for all displayable content. Each subdirectory within `EXPRESS/` is treated as a distinct section in the Table of Contents.
    - `src/`: Contains core JavaScript modules.
        - `src/auto-storage.js`: (If applicable, based on `test.html` content) Manages automatic saving and restoring of form field values to `localStorage`.
        - `src/simple-storage.js`: (If applicable) Provides a simplified interface for `localStorage` operations, potentially with prefixing.
        - `src/storage-manager.js`: (If applicable) Manages prefixed storage in `localStorage`, offering features like clearing all prefixed items.
        - `src/env-config.js`: (If applicable) Placeholder for environment-specific configurations, potentially used by `index.html` for auth settings.
    - `scripts/`: (Currently empty, but intended for future build or utility scripts).
    - `generate-toc.js`: A Node.js script that scans the `EXPRESS/` directory and generates `toc.html`.
    - `add-content.js`: A Node.js script that helps scaffold new content sections within the `EXPRESS/` directory and automatically updates the TOC.
    - `PROJECT_OVERVIEW.md`: This document, providing a comprehensive guide to the template.
    - `package.json`: Defines project metadata, dependencies (e.g., for Node.js scripts), and script commands.
    - `.gitignore`: Specifies files and directories that Git should ignore (e.g., `node_modules`, OS-generated files).
    - `test.html`: A sample page used for testing various features, including storage utilities and theme propagation.
    - `netlify.toml`: Configuration file for deploying the project on Netlify.

## 4. Content Management
    - **Content Directory**: All content intended for display must reside in subdirectories within the `EXPRESS/` directory. Each subdirectory represents a section in the TOC.
    - **Table of Contents Generation (`generate-toc.js`)**:
        - **How it works**: The script scans all subdirectories within `EXPRESS/`.
        - **Page identification**:
            - It looks for `page.html` or `index.html` as the primary entry point for a section.
            - Other `.html` files within the section directory are treated as secondary (sub-page) entries and are listed nested under the primary page.
        - **Title extraction**:
            - Uses the content of the `<title>` tag from each HTML file.
            - If a section has no primary page but contains secondary pages, the section directory name is used as a non-clickable heading for the nested list.
        - **Sorting**: Sections in the TOC are sorted alphabetically. Secondary pages within a section are also sorted alphabetically by their extracted titles.
        - **Running the script**: Execute `node generate-toc.js` from the project root to update `toc.html`. This is often run automatically by `add-content.js`.
    - **Adding New Content (`add-content.js`)**:
        - **Purpose**: This script simplifies the creation of new content sections. It creates the specified subdirectory within `EXPRESS/` and generates a default `page.html` file.
        - **Generated Page Features**: The default `page.html` includes:
            - A link to `assets/styles/main.css`.
            - The necessary JavaScript for theme handling (responding to `postMessage` from the parent and checking `localStorage`).
            - An inline style `padding: 20px;` on the `<body>` tag for consistent content spacing.
            - A list of other files present in its own directory.
        - **Automatic TOC Update**: After creating the new section and `page.html`, `add-content.js` automatically runs `generate-toc.js`.
        - **Usage**: `node add-content.js EXPRESS/your-new-section-name`.

## 5. Authentication
    - **Login Page**: `login.html` serves as the entry point for password authentication.
    - **Password Hashing**: Client-side password hashing is performed using the SHA256 algorithm via the `crypto.subtle.digest` Web API. The default password is "TEST_PROJECT", and its pre-calculated SHA256 hash (`c44267c8b6a0f19268d96cfd59aa6a42b6ad7571f35bfa6752dce77e04922673`) is stored directly in `login.html`.
    - **Session Management**: Upon successful authentication, an `isAuthenticated` flag is set to `true` in `sessionStorage`. This flag is checked by `index.html` to control access.
    - **Redirection**: If `sessionStorage.getItem('isAuthenticated')` is not `true`, `index.html` automatically redirects the user to `login.html`.

## 6. Theming
    - **CSS Variables**: Theming is implemented using CSS custom properties (variables) defined in `assets/styles/main.css`. Separate sets of variables are defined within `:root` (for the light theme) and `body.dark-theme` (for the dark theme).
    - **Theme Toggle**: A "Toggle Theme" button in the sidebar of `index.html` allows users to switch between light and dark themes.
    - **Persistence**: The user's theme preference is saved in `localStorage` (key: `theme`, value: `light` or `dark`) and applied on subsequent visits.
    - **Application to Iframes**: Theme changes are propagated from the main page (`index.html`) to the content loaded in iframes. This is achieved using `window.postMessage` to send the theme status to the iframe. Iframe content pages include a script to listen for these messages and apply the theme, as well as check `localStorage` on initial load.

## 7. Adding New Content (Step-by-Step)
    - **A. Static HTML Content**:
        1. **Create Directory**: Create a new subdirectory inside `EXPRESS/`. For example: `EXPRESS/my-new-topic`.
        2. **Add HTML Files**: Place your HTML files (e.g., `main-topic.html`, `details.html`) inside this new directory. Ensure each HTML file has a meaningful `<title>` tag, as this will be used in the Table of Contents.
        3. **Use `add-content.js` (Recommended for Default Setup)**: Run `node add-content.js EXPRESS/my-new-topic`.
            - If `my-new-topic/page.html` or `my-new-topic/index.html` doesn't exist, this script will create a default `page.html`. This default page will include the theme handling script, body padding, and will list other files in the `my-new-topic` directory.
            - The script automatically runs `generate-toc.js` to update the TOC.
        4. **Manual TOC Update (If Not Using `add-content.js`)**: If you manually create all files, ensure you run `node generate-toc.js` from the project root to make your new section and its pages appear in the sidebar navigation.
        5. **Verification**: The new section and its pages (primary, then secondary sorted alphabetically) should now be visible in the Table of Contents.

    - **B. Complex JavaScript Applications (e.g., React, Vue, D3, Three.js)**:
        1. **Development**: Develop your application as you normally would (e.g., using its own CLI, in a separate project, or within a dedicated subdirectory like `src_apps/my-complex-app-source`).
        2. **Build**: Configure your application's build process to output all static assets (HTML, CSS, JavaScript bundles, images, etc.) into a single directory.
        3. **Output Directory**: Set the build output directory to be a new subdirectory within `EXPRESS/`. For example, if your app is named "DataVisualizer", build it into `EXPRESS/data-visualizer/`. The main entry point of your built app should typically be an `index.html` file in this output directory.
        4. **Update TOC**: Run `node generate-toc.js`. The script will identify the `index.html` (or `page.html`) in `EXPRESS/data-visualizer/` as the primary page for that section and add it to the Table of Contents. Any other HTML files in the `EXPRESS/data-visualizer/` directory will be listed as secondary pages.
        5. **Iframe Considerations**:
            - **Theme Propagation**: Ensure your complex application can receive and apply theme changes. If it manages its own styling, it might need to listen to the `postMessage` event for theme changes (see the script in generated `page.html` for an example) or directly check `localStorage.getItem('theme')`.
            - **Communication**: For more complex interactions between the iframe and the parent shell (beyond theming), use `window.parent.postMessage()` from the iframe and `window.addEventListener('message', ...)` in `index.html`.
            - **Sandbox Attributes**: The iframe in `index.html` is created without specific sandbox attributes. If your application requires particular permissions (e.g., `allow-scripts allow-same-origin allow-popups`), you would need to manually modify the iframe creation logic in `index.html` to add the necessary `sandbox` attribute. This is an advanced customization.
            - **Performance**: Be mindful of your application's bundle size and loading performance, as it will be loaded within an iframe.

## 8. Scripts
    - `node generate-toc.js`: Scans the `EXPRESS/` directory and regenerates the `toc.html` file.
    - `node add-content.js EXPRESS/<section-name>`: Creates a new content section directory named `<section-name>` within `EXPRESS/`, adds a default `page.html` (if no primary page exists), and then automatically runs `generate-toc.js`.
    - `npm start` / `npm run dev`: The root `package.json` does not currently define these scripts for global project serving. They might be used if individual complex applications (e.g., a React app within `src_apps/`) have their own `package.json` and associated scripts. For simple static content viewing, you can use a local HTTP server extension in your IDE or a simple command like `python -m http.server` or `npx serve`.
    - `npm run build`: No root-level build process is defined in the main `package.json`. This command would be relevant for individual complex applications that have their own build steps.

## 9. Deployment
    - **General**: This project generates a set of static HTML, CSS, and JavaScript files that can be hosted on any static web hosting provider.
    - **GitHub Pages**:
        1. Ensure a `.nojekyll` file is present in the root of your deployment branch (usually `main` or `gh-pages`) to prevent Jekyll processing. (This file is already included).
        2. In your GitHub repository settings, go to "Pages".
        3. Select the branch you want to deploy from (e.g., `main`).
        4. Select the folder to serve from (usually `/ (root)`).
        5. GitHub Pages will host your site.
    - **Netlify**:
        1. The repository includes a `netlify.toml` file with basic configuration:
            ```toml
            [build]
              command = "echo 'No global build command needed. Ensure generate-toc.js has been run.'"
              publish = "."
            ```
           This tells Netlify that no specific build command is needed at the root for this template (as `toc.html` is generated manually or via `add-content.js` during development) and to publish the current directory.
        2. Connect your GitHub repository to Netlify.
        3. Netlify will automatically detect `netlify.toml` and deploy your site.
        4. **Important**: Ensure `toc.html` is up-to-date in your repository before deploying. Consider adding `node generate-toc.js` as part of a pre-commit hook or a manual step before pushing changes if you frequently update content structure without using `add-content.js`.

## 10. Customization & Future Enhancements
    - **Modifying Themes**:
        - Edit the CSS variables under `:root` (light theme) and `body.dark-theme` in `assets/styles/main.css`.
        - Add or modify styles for specific components as needed, using these variables.
    - **Changing Default Password**:
        1. Choose a new password.
        2. Calculate its SHA256 hash. You can use an online tool or a simple Node.js script:
           ```javascript
           // In Node.js
           const crypto = require('crypto');
           console.log(crypto.createHash('sha256').update('YOUR_NEW_PASSWORD').digest('hex'));
           ```
        3. Replace the `PRECALCULATED_HASH` value in `login.html` with your new hash.
    - **Extending Functionality (Ideas)**:
        - **Build Process Integration**: Integrate `generate-toc.js` into a more formal build process (e.g., using npm scripts in `package.json` that might also handle minification or other optimizations if the project grows).
        - **Content Type Detection**: Enhance `generate-toc.js` to detect different content types (e.g., Markdown files that get converted to HTML on the fly, though this would require additional tooling).
        - **Search Functionality**: Add client-side search for content pages.
        - **Improved UI/UX**: Further refine the user interface, add animations, or enhance mobile responsiveness.
        - **Server-Side Rendering (SSR) or Static Site Generation (SSG)**: For larger projects or SEO needs, transition to a full SSG framework like Next.js, Eleventy, or Astro, using this template's concepts as a base.
        - **More Granular `env-config.js` Usage**: Fully utilize `src/env-config.js` for configurations like the password hash or other site settings, potentially loading it differently in development vs. production.

This project provides a solid foundation for a modular content hub. Feel free to adapt and extend it to meet your specific project requirements.
```
